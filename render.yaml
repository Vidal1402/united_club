# Render Blueprint - United Club Backend
# https://docs.render.com/blueprint-spec

services:
  - type: web
    name: united-club-api
    runtime: node

    # Build: instala deps, gera Prisma Client, compila NestJS, roda seed (cria admin + níveis)
    buildCommand: npm install --legacy-peer-deps && npm run prisma:generate && npm run build && npm run prisma:seed

    # Start: instala, gera Prisma, compila e sobe (dist/ não é preservado entre build e start no Render)
    startCommand: npm install --legacy-peer-deps && npm run prisma:generate && npm run build && node dist/main.js

    envVars:
      - key: NODE_ENV
        value: production
